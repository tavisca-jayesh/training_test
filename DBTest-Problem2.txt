Database Query
#1)find salary per Q
#2)find order amount per quarter
#3)find Exp/Earn
#4)find growth
#5)display in view

------------------------

#1) 
#1.1)
select a quarter

SELECT DATEPART(qq,OrderDate) 
  FROM [Assignment].[dbo].[Orders]
  
#1.2) 
find employees paid in that period

SELECT [Name],[Salary]
  FROM [Assignment].[dbo].[Employees]
  where JoiningDate < EndDate(Qi)

#1.3)
Find Salary Paid for a quarter

SELECT SUM(SalaryThisQuarter) FROM (SELECT [Name],Round(Salary/12,0)*(DATEPART(MM,'2013-06-30'-JoiningDate)) as SalaryThisQuarter
  FROM [Assignment].[dbo].[Employees]
  where JoiningDate < '2013-06-30') AS sumass
  
Last Date of quarter with JoiningDate
DateAdd(day, -1, dateadd(qq, DateDiff(qq, 0, JoiningDate)+1, 0))
  
#1.4)
Find Salary Paid in their joining Quarter


SELECT DATEPART(YEAR,E.JoiningDate) [Year],
 DATEPART(QUARTER,E.JoiningDate) [Quarter], SUM(ROUND(E.SALARY/12,0)*(DATEPART(MM,DateAdd(day, -1, dateadd(qq, DateDiff(qq, 0, E.JoiningDate)+1, 0))-E.JoiningDate)))
FROM [Assignment].[dbo].[Employees] as E
GROUP BY DATEPART(YEAR,E.JoiningDate),DATEPART(QUARTER,E.JoiningDate)
ORDER BY 1,2

Finding Salary paid for a quarter


SELECT 
 DATEPART(YEAR,E.JoiningDate) [Year],
 DATEPART(QUARTER,E.JoiningDate) [Quarter], 
 SUM(ROUND(E.SALARY/12,0)*(DATEPART(MM,'2013-06-30'-JoiningDate))) [SalaryQuarter]
FROM [Assignment].[dbo].[Employees] as E
GROUP BY DATEPART(YEAR,E.JoiningDate),DATEPART(QUARTER,E.JoiningDate)
ORDER BY 1,2

-----------------------------  
#2) 
order amount per quarter

SELECT YEAR(OrderDate) as year, DATEPART(qq,OrderDate) as quarter , SUM(OrderAmount) as totalorder
  FROM [Assignment].[dbo].[Orders]
  GROUP BY YEAR(OrderDate), DATEPART(qq,OrderDate)
  Order By YEAR(OrderDate), DATEPART(qq,OrderDate)
  
-------------------------------
